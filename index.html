<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud BI & ML Operations Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        :root {
            --primary-color: #667eea; /* A vibrant blue/purple */
            --secondary-color: #764ba2; /* A deeper purple */
            --accent-color: #4ECDC4; /* Teal */
            --background-color: #f4f7f6; /* Light gray background */
            --card-background: #ffffff; /* White cards */
            --text-color: #333333; /* Dark gray text */
            --light-text-color: #666666; /* Lighter gray text */
            --border-color: #e0e0e0; /* Light border for elements */
            --sidebar-width: 250px;
            --header-height: 60px;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            display: flex;
            height: 100vh;
            color: var(--text-color);
            overflow: hidden; /* Prevent body scroll, content will scroll */
        }

        /* Layout */
        .dashboard-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        /* Header (Top Bar) */
        .header {
            width: calc(100% - var(--sidebar-width));
            height: var(--header-height);
            background-color: var(--card-background);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            position: fixed;
            top: 0;
            left: var(--sidebar-width);
            z-index: 1000;
        }

        .header-left .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .header-right .icon-menu {
            font-size: 24px;
            color: var(--light-text-color);
            cursor: pointer;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--secondary-color);
            color: white;
            padding-top: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            position: fixed;
            height: 100%;
            display: flex;
            flex-direction: column;
            z-index: 1100;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .sidebar-header .app-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            color: white;
        }

        .sidebar-header .app-subtitle {
            font-size: 14px;
            opacity: 0.8;
        }

        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-nav ul li a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            transition: background-color 0.3s ease, padding-left 0.3s ease;
        }

        .sidebar-nav ul li a i {
            margin-right: 15px;
            font-size: 20px;
        }

        .sidebar-nav ul li a:hover,
        .sidebar-nav ul li a.active {
            background-color: rgba(255, 255, 255, 0.2);
            padding-left: 30px;
        }

        /* Main Content Area */
        .main-content {
            margin-left: var(--sidebar-width);
            padding-top: var(--header-height); /* Space for fixed header */
            flex-grow: 1;
            overflow-y: auto; /* Enable scrolling for content */
            height: calc(100vh - var(--header-height)); /* Ensure content area takes up remaining height */
            box-sizing: border-box; /* Include padding in height calculation */
        }

        .page {
            display: none; /* Hidden by default */
            padding: 20px;
        }

        .page.active {
            display: block; /* Show active page */
        }

        .page-title {
            font-size: 28px;
            font-weight: 500;
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        /* Card styles */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            color: var(--text-color);
        }

        .card-icon {
            font-size: 24px;
            color: var(--primary-color);
        }

        .kpi-card {
            text-align: center;
        }

        .kpi-card .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .kpi-card .kpi-label {
            font-size: 14px;
            color: var(--light-text-color);
            margin-bottom: 10px;
        }

        .kpi-card .kpi-change {
            font-size: 14px;
            font-weight: 500;
        }

        .kpi-card .kpi-change.positive {
            color: var(--success-color);
        }

        .kpi-card .kpi-change.negative {
            color: var(--danger-color);
        }

        .chart-card {
            height: 350px; /* Fixed height for charts */
            display: flex;
            flex-direction: column;
        }

        .chart-container {
            flex-grow: 1;
            min-height: 0; /* Allow Plotly to resize correctly */
        }

        /* Tabs */
        .tab-container {
            margin-bottom: 20px;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .tab-button {
            background-color: transparent;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 16px;
            color: var(--light-text-color);
            transition: color 0.3s ease, border-bottom 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-right: 10px;
        }

        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 500;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Forms and Buttons */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--light-text-color);
        }

        select, input[type="number"], input[type="range"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
            background-color: var(--card-background);
            color: var(--text-color);
        }

        input[type="range"] {
            padding: 0;
        }

        .button {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }

        .button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-1px);
        }

        .button:active {
            transform: translateY(0);
        }

        /* Specific for ML Workflows */
        .workflow-panel {
            display: none;
            background-color: var(--card-background);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }

        .workflow-panel.active {
            display: block;
        }

        .workflow-chart-container {
            height: 200px;
            margin-bottom: 20px;
        }

        .execution-log {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap; /* Preserve whitespace and wrap lines */
            word-wrap: break-word; /* Break long words */
            margin-top: 20px;
            border-radius: 5px;
        }

        .execution-results {
            background-color: #e6ffe6;
            border: 1px solid #c8e6c9;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
            color: #2e7d32;
        }

        .execution-results h4 {
            margin-top: 0;
            color: #1b5e20;
        }
        
        /* Insights Specific */
        .insight-card {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .insight-card h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .insight-card p {
            color: var(--light-text-color);
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .insight-card .kpi-group {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .insight-card .kpi-item {
            text-align: center;
            flex: 1 1 120px; /* Allow items to grow/shrink */
            min-width: 100px;
        }

        .insight-card .kpi-item .value {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 5px;
        }

        .insight-card .kpi-item .label {
            font-size: 13px;
            color: var(--light-text-color);
        }

        /* Small chart within KPI card */
        .kpi-chart-mini {
            height: 120px; /* Adjust as needed */
            width: 100%;
        }

        /* Model Overview specific styles */
        .model-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .status-card {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            padding: 20px;
        }

        .status-card h4 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 18px;
            margin-bottom: 15px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-item span:first-child {
            font-weight: 500;
            color: var(--text-color);
        }

        .status-item span:last-child {
            color: var(--light-text-color);
        }

        .status-indicator {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-transform: uppercase;
        }

        .status-indicator.success { background-color: var(--success-color); }
        .status-indicator.warning { background-color: var(--warning-color); }
        .status-indicator.danger { background-color: var(--danger-color); }
        .status-indicator.info { background-color: var(--info-color); }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <div class="header-left">
                <div class="logo">Cloud BI & ML Ops</div>
            </div>
            <div class="header-right">
                <i class="material-icons icon-menu">more_vert</i> </div>
        </div>
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="app-title">BI-ML Platform</div>
                <div class="app-subtitle">Analytics & Operations</div>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li>
                        <a href="#" class="nav-link active" data-page="dashboard">
                            <i class="fas fa-chart-line"></i> Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link" data-page="ml-workflows">
                            <i class="fas fa-project-diagram"></i> ML Workflows
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link" data-page="model-performance">
                            <i class="fas fa-tachometer-alt"></i> Model Performance
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link" data-page="business-insights">
                            <i class="fas fa-lightbulb"></i> Business Insights
                        </a>
                    </li>
                    <li style="margin-top: 30px; text-transform: uppercase; font-size: 12px; opacity: 0.7; padding: 10px 25px;">Cloud Platforms</li>
                    <li>
                        <a href="#" class="nav-link" data-page="aws-sagemaker">
                            <i class="fab fa-aws"></i> AWS SageMaker
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link" data-page="gcp-vertexai">
                            <i class="fas fa-cloud"></i> GCP Vertex AI
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link" data-page="tableau-powerbi">
                            <i class="fas fa-database"></i> Data Viz
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="main-content">
            <div id="dashboard" class="page active">
                <h1 class="page-title">Real-time Analytics Dashboard</h1>
                
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="realtime">Real-time Analytics</button>
                        <button class="tab-button" data-tab="predictive">Predictive Insights</button>
                        <button class="tab-button" data-tab="overview">Model Overview</button>
                    </div>

                    <div id="realtime" class="tab-content active">
                        <div class="card-grid">
                            <div class="card kpi-card">
                                <div class="card-header">
                                    <h2 class="card-title">Total Sales</h2>
                                    <i class="fas fa-dollar-sign card-icon"></i>
                                </div>
                                <div class="kpi-value">1,560,000</div>
                                <div class="kpi-label">USD (Today)</div>
                                <div class="kpi-change positive">+1.2%</div>
                            </div>
                            <div class="card kpi-card">
                                <div class="card-header">
                                    <h2 class="card-title">New Customers</h2>
                                    <i class="fas fa-users card-icon"></i>
                                </div>
                                <div class="kpi-value">284</div>
                                <div class="kpi-label">Acquired (Today)</div>
                                <div class="kpi-change positive">+5.8%</div>
                            </div>
                            <div class="card kpi-card">
                                <div class="card-header">
                                    <h2 class="card-title">Active Models</h2>
                                    <i class="fas fa-brain card-icon"></i>
                                </div>
                                <div class="kpi-value">12</div>
                                <div class="kpi-label">Deployed (Live)</div>
                                <div class="kpi-change positive">+0.0%</div>
                            </div>
                            <div class="card kpi-card">
                                <div class="card-header">
                                    <h2 class="card-title">Avg. Prediction Accuracy</h2>
                                    <i class="fas fa-bullseye card-icon"></i>
                                </div>
                                <div class="kpi-value">92.4%</div>
                                <div class="kpi-label">Overall (Last 24H)</div>
                                <div class="kpi-change positive">+0.1%</div>
                            </div>
                        </div>

                        <div class="card-grid" style="grid-template-columns: 2fr 1fr;">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Daily Sales Trend</h2>
                                    <i class="fas fa-chart-area card-icon"></i>
                                </div>
                                <div class="chart-container" id="sales-chart"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Segments</h2>
                                    <i class="fas fa-chart-pie card-icon"></i>
                                </div>
                                <div class="chart-container" id="segments-chart"></div>
                            </div>
                        </div>

                        <div class="card chart-card">
                            <div class="card-header">
                                <h2 class="card-title">Revenue & Product Category Performance</h2>
                                <i class="fas fa-chart-bar card-icon"></i>
                            </div>
                            <div class="chart-container" id="revenue-chart"></div>
                        </div>
                    </div>
                    <div id="predictive" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Predictive Analytics</h2>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">30-Day Sales Forecast</h2>
                                    <i class="fas fa-chart-line card-icon"></i>
                                </div>
                                <div class="chart-container" id="forecast-chart"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Lifetime Value (CLV) Distribution</h2>
                                    <i class="fas fa-chart-bar card-icon"></i>
                                </div>
                                <div class="chart-container" id="clv-chart"></div>
                            </div>
                            <div class="card chart-card" style="grid-column: span 2;">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Churn Risk Distribution</h2>
                                    <i class="fas fa-exclamation-triangle card-icon"></i>
                                </div>
                                <div class="chart-container" id="churn-chart"></div>
                            </div>
                        </div>
                    </div>

                    <div id="overview" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Model Overview & Health</h2>
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Overall Model Health</h2>
                                    <i class="fas fa-heartbeat card-icon"></i>
                                </div>
                                <p><strong>Total Models Deployed:</strong> 12</p>
                                <p><strong>Average Uptime:</strong> 99.9%</p>
                                <p><strong>Last Incident:</strong> None (2 days ago)</p>
                                <p><strong>Data Latency:</strong> ~50ms</p>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Model Performance Summary</h2>
                                    <i class="fas fa-chart-pie card-icon"></i>
                                </div>
                                <p><strong>Highest Accuracy:</strong> Sales Forecasting (94.2%)</p>
                                <p><strong>Lowest Drift:</strong> Customer Segmentation (0.08)</p>
                                <p><strong>Most Active:</strong> Churn Prediction</p>
                                <p><strong>Average Prediction Volume:</strong> 2,847 / day</p>
                            </div>
                            <div class="card status-card" style="grid-column: span 2;">
                                <div class="card-header">
                                    <h2 class="card-title">Training Pipeline Status</h2>
                                    <i class="fas fa-code-branch card-icon"></i>
                                </div>
                                <div class="model-status-grid">
                                    <div class="status-card">
                                        <h4>Sales Forecasting Pipeline</h4>
                                        <div class="status-item"><span>Last Run:</span> <span>2025-07-01 10:30 AM</span></div>
                                        <div class="status-item"><span>Status:</span> <span class="status-indicator success">Success</span></div>
                                        <div class="status-item"><span>Duration:</span> <span>15 min</span></div>
                                        <div class="status-item"><span>Accuracy:</span> <span>94.2%</span></div>
                                        <div class="status-item"><span>Next Schedule:</span> <span>Daily 03:00 AM</span></div>
                                    </div>
                                    <div class="status-card">
                                        <h4>Churn Prediction Pipeline</h4>
                                        <div class="status-item"><span>Last Run:</span> <span>2025-06-28 08:00 AM</span></div>
                                        <div class="status-item"><span>Status:</span> <span class="status-indicator warning">Warning</span></div>
                                        <div class="status-item"><span>Duration:</span> <span>22 min</span></div>
                                        <div class="status-item"><span>Accuracy:</span> <span>90.1%</span></div>
                                        <div class="status-item"><span>Next Schedule:</span> <span>Weekly Sunday</span></div>
                                    </div>
                                    <div class="status-card">
                                        <h4>Customer Segmentation Pipeline</h4>
                                        <div class="status-item"><span>Last Run:</span> <span>2025-07-02 01:00 AM</span></div>
                                        <div class="status-item"><span>Status:</span> <span class="status-indicator info">Running</span></div>
                                        <div class="status-item"><span>Duration:</span> <span>(In progress)</span></div>
                                        <div class="status-item"><span>Status:</span> <span class="status-indicator info">Data Processing</span></div>
                                        <div class="status-item"><span>Next Schedule:</span> <span>Monthly</span></div>
                                    </div>
                                    <div class="status-card">
                                        <h4>Price Optimization Pipeline</h4>
                                        <div class="status-item"><span>Last Run:</span> <span>2025-06-15 09:00 PM</span></div>
                                        <div class="status-item"><span>Status:</span> <span class="status-indicator success">Success</span></div>
                                        <div class="status-item"><span>Duration:</span> <span>30 min</span></div>
                                        <div class="status-item"><span>Revenue Impact:</span> <span>+15.6%</span></div>
                                        <div class="status-item"><span>Next Schedule:</span> <span>Bi-weekly</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="ml-workflows" class="page">
                <h1 class="page-title">ML Workflows & Automation</h1>
                
                <div class="card">
                    <div class="form-group">
                        <label for="workflow-select">Select ML Workflow:</label>
                        <select id="workflow-select">
                            <option value="sales-forecasting-workflow">Sales Forecasting</option>
                            <option value="customer-segmentation-workflow">Customer Segmentation</option>
                            <option value="churn-prediction-workflow">Churn Prediction</option>
                            <option value="price-optimization-workflow">Price Optimization</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="horizon-slider">Forecast Horizon (Days): <span id="horizon-value">30</span></label>
                        <input type="range" id="horizon-slider" min="7" max="180" value="30">
                    </div>
                    <button class="button" onclick="executePipeline()">Execute Workflow</button>
                    
                    <div class="execution-log" id="execution-log">
                        Pipeline execution log will appear here...
                    </div>
                    <div class="execution-results" id="execution-results" style="display: none;">
                        </div>
                </div>

                <div id="sales-forecasting-workflow" class="workflow-panel active">
                    <h3 class="card-title">Sales Forecasting Pipeline</h3>
                    <p><strong>Description:</strong> Predicts future sales based on historical data, seasonality, and marketing spend.</p>
                    <p><strong>Algorithm:</strong> ARIMA + XGBoost Hybrid</p>
                    <p><strong>Inputs:</strong> Historical Sales, Marketing Spend, Economic Indicators</p>
                    <p><strong>Outputs:</strong> Forecasted Sales, Confidence Intervals</p>
                    <div class="workflow-chart-container" id="sales-forecasting-workflow-diagram"></div>
                </div>
                <div id="customer-segmentation-workflow" class="workflow-panel">
                    <h3 class="card-title">Customer Segmentation Pipeline</h3>
                    <p><strong>Description:</strong> Groups customers into distinct segments based on their behavior and demographics.</p>
                    <p><strong>Algorithm:</strong> K-Means Clustering</p>
                    <p><strong>Inputs:</strong> Recency, Frequency, Monetary (RFM), Demographics</p>
                    <p><strong>Outputs:</strong> Segment Labels, Cluster Profiles</p>
                    <div class="workflow-chart-container" id="customer-segmentation-workflow-diagram"></div>
                </div>

                <div id="churn-prediction-workflow" class="workflow-panel">
                    <h3 class="card-title">Churn Prediction Pipeline</h3>
                    <p><strong>Description:</strong> Identifies customers at high risk of churning, enabling proactive retention efforts.</p>
                    <p><strong>Algorithm:</strong> Random Forest Classifier</p>
                    <p><strong>Inputs:</strong> Transaction History, Support Interactions, Engagement Metrics</p>
                    <p><strong>Outputs:</strong> Churn Probability, Risk Factors</p>
                    <div class="workflow-chart-container" id="churn-prediction-workflow-diagram"></div>
                </div>

                <div id="price-optimization-workflow" class="workflow-panel">
                    <h3 class="card-title">Price Optimization Pipeline</h3>
                    <p><strong>Description:</strong> Recommends optimal pricing strategies to maximize revenue or profit margins.</p>
                    <p><strong>Algorithm:</strong> XGBoost Regressor</p>
                    <p><strong>Inputs:</strong> Current Price, Competitor Prices, Demand Elasticity</p>
                    <p><strong>Outputs:</strong> Optimal Price, Revenue Impact Analysis</p>
                    <div class="workflow-chart-container" id="price-optimization-workflow-diagram"></div>
                </div>
            </div>
            <div id="model-performance" class="page">
                <h1 class="page-title">Model Performance & Monitoring</h1>
                
                <div class="card">
                    <div class="form-group">
                        <label for="model-select">Select Model:</label>
                        <select id="model-select">
                            <option value="sales-forecasting">Sales Forecasting</option>
                            <option value="churn-prediction">Churn Prediction</option>
                            <option value="customer-segmentation">Customer Segmentation</option>
                            <option value="price-optimization">Price Optimization</option>
                        </select>
                    </div>
                </div>

                <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                    <div class="card kpi-card performance-metric">
                        <div class="card-header">
                            <h3 class="card-title">Overall Accuracy</h3>
                            <i class="fas fa-check-circle card-icon"></i>
                        </div>
                        <div class="kpi-value">94.2%</div>
                        <div class="kpi-label">Current Performance</div>
                    </div>
                    <div class="card kpi-card performance-metric">
                        <div class="card-header">
                            <h3 class="card-title">Precision</h3>
                            <i class="fas fa-crosshairs card-icon"></i>
                        </div>
                        <div class="kpi-value">89.3%</div>
                        <div class="kpi-label">Average</div>
                    </div>
                    <div class="card kpi-card performance-metric">
                        <div class="card-header">
                            <h3 class="card-title">Recall</h3>
                            <i class="fas fa-hand-holding-heart card-icon"></i>
                        </div>
                        <div class="kpi-value">90.1%</div>
                        <div class="kpi-label">Average</div>
                    </div>
                    <div class="card kpi-card performance-metric">
                        <div class="card-header">
                            <h3 class="card-title">F1 Score</h3>
                            <i class="fas fa-balance-scale card-icon"></i>
                        </div>
                        <div class="kpi-value">89.7%</div>
                        <div class="kpi-label">Average</div>
                    </div>
                </div>

                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="metrics">Detailed Metrics</button>
                        <button class="tab-button" data-tab="validation">Model Validation</button>
                        <button class="tab-button" data-tab="features">Feature Analysis</button>
                        <button class="tab-button" data-tab="monitoring">Real-time Monitoring</button>
                    </div>

                    <div id="metrics" class="tab-content active">
                        <div class="card-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Model Accuracy Trend</h2>
                                    <i class="fas fa-chart-line card-icon"></i>
                                </div>
                                <div class="chart-container" id="performance-trend-chart"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Confusion Matrix</h2>
                                    <i class="fas fa-table card-icon"></i>
                                </div>
                                <div class="chart-container" id="confusion-matrix"></div>
                            </div>
                        </div>
                        <div class="card-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">ROC Curve</h2>
                                    <i class="fas fa-chart-area card-icon"></i>
                                </div>
                                <div class="chart-container" id="roc-curve"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Precision-Recall Curve</h2>
                                    <i class="fas fa-chart-bar card-icon"></i>
                                </div>
                                <div class="chart-container" id="pr-curve"></div>
                            </div>
                        </div>
                        <div class="card chart-card">
                            <div class="card-header">
                                <h2 class="card-title">Feature Importance</h2>
                                <i class="fas fa-list-ol card-icon"></i>
                            </div>
                            <div class="chart-container" id="feature-importance"></div>
                        </div>
                    </div>
                    <div id="validation" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Model Validation Insights</h2>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Cross-Validation Scores</h2>
                                    <i class="fas fa-chart-bar card-icon"></i>
                                </div>
                                <div class="chart-container" id="cv-scores-chart"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Learning Curves</h2>
                                    <i class="fas fa-chart-line card-icon"></i>
                                </div>
                                <div class="chart-container" id="learning-curves-chart"></div>
                            </div>
                        </div>
                    </div>

                    <div id="features" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Feature Engineering & Analysis</h2>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Feature Importance</h2>
                                    <i class="fas fa-list-ol card-icon"></i>
                                </div>
                                <div class="chart-container" id="feature-importance"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Feature Correlation Matrix</h2>
                                    <i class="fas fa-th card-icon"></i>
                                </div>
                                <div class="chart-container" id="correlation-matrix"></div>
                            </div>
                        </div>
                    </div>

                    <div id="monitoring" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Real-time Model Monitoring</h2>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Model Response Time</h2>
                                    <i class="fas fa-clock card-icon"></i>
                                </div>
                                <div class="chart-container" id="response-time-chart"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Data Drift Index</h2>
                                    <i class="fas fa-arrows-alt-h card-icon"></i>
                                </div>
                                <div class="chart-container" id="data-drift-chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="business-insights" class="page">
                <h1 class="page-title">Business Insights & Strategy</h1>
                
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="revenue">Revenue Intelligence</button>
                        <button class="tab-button" data-tab="customer">Customer Analytics</button>
                        <button class="tab-button" data-tab="market">Market Trends</button>
                        <button class="tab-button" data-tab="recommendations">Recommendations</button>
                    </div>

                    <div id="revenue" class="tab-content active">
                        <h2 style="margin-bottom: 20px;">Revenue Growth & Optimization</h2>
                        <div class="card-grid" style="grid-template-columns: 2fr 1fr;">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Quarterly Revenue Forecast</h2>
                                    <i class="fas fa-chart-line card-icon"></i>
                                </div>
                                <div class="chart-container" id="revenue-forecast-chart"></div>
                            </div>
                            <div class="card insight-card">
                                <h3>Key Revenue Insights</h3>
                                <p>Revenue growth of <span style="color: var(--success-color); font-weight: bold;">+12.3%</span> in Q2 driven by new product launches.</p>
                                <p><strong>Top Performing Product Line:</strong> Cloud Solutions</p>
                                <p><strong>Opportunities:</strong> Expand into APAC region, optimize pricing for Tier 2 customers.</p>
                                <div class="kpi-group">
                                    <div class="kpi-item"><div class="value">2.8M</div><div class="label">Current Qtr Revenue</div></div>
                                    <div class="kpi-item"><div class="value">+1.2%</div><div class="label">Avg Order Value Growth</div></div>
                                </div>
                            </div>
                        </div>

                        <div class="card-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Revenue Contribution by Driver</h2>
                                    <i class="fas fa-chart-pie card-icon"></i>
                                </div>
                                <div class="chart-container" id="revenue-drivers-chart"></div>
                            </div>
                            <div class="card insight-card">
                                <h3>Pricing Optimization Recommendation</h3>
                                <p>Analysis indicates an optimal price point of <span style="color: var(--accent-color); font-weight: bold;">$95</span> for product X, potentially increasing revenue by <span style="color: var(--success-color); font-weight: bold;">15%</span>.</p>
                                <p>This strategy considers demand elasticity and competitor pricing.</p>
                                <div class="chart-container kpi-chart-mini" id="pricing-optimization"></div>
                            </div>
                        </div>
                    </div>
                    <div id="customer" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Customer Behavior & Segmentation</h2>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Journey Funnel</h2>
                                    <i class="fas fa-funnel-dollar card-icon"></i>
                                </div>
                                <div class="chart-container" id="customer-funnel"></div>
                            </div>
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Customer Lifetime Value (CLV) Distribution</h2>
                                    <i class="fas fa-chart-bar card-icon"></i>
                                </div>
                                <div class="chart-container" id="clv-distribution-chart"></div>
                            </div>
                        </div>
                        <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                            <div class="card insight-card">
                                <h3>Customer Segments Breakdown</h3>
                                <p><strong>Champions:</strong> 234 customers, driving 12.3% of total revenue. High engagement.</p>
                                <p><strong>Loyal Customers:</strong> 567 customers, consistent purchases, high retention.</p>
                                <div class="chart-container kpi-chart-mini" id="customer-segments"></div>
                            </div>
                            <div class="card insight-card">
                                <h3>At-Risk Customers</h3>
                                <p><span style="color: var(--danger-color); font-weight: bold;">189</span> customers identified as high churn risk.</p>
                                <p><strong>Top factors:</strong> Decreased engagement, less frequent purchases, unresolved support tickets.</p>
                                <p><strong>Recommended Action:</strong> Targeted re-engagement campaigns and personalized offers.</p>
                            </div>
                        </div>
                    </div>

                    <div id="market" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Market Trends & Competitive Analysis</h2>
                        <div class="card insight-card">
                            <h3>Market Growth Opportunities</h3>
                            <p>Analysis of market data suggests significant growth potential in the "AI-driven Analytics" segment (+25% CAGR).</p>
                            <p><strong>Key Competitors:</strong> [Competitor A], [Competitor B]</p>
                            <p><strong>Strategy:</strong> Focus on unique selling propositions in data privacy and scalability.</p>
                        </div>
                        <div class="card-grid">
                            <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Market Share Trend</h2>
                                    <i class="fas fa-chart-area card-icon"></i>
                                </div>
                                <div class="chart-container" id="market-share-chart"></div>
                            </div>
                             <div class="card chart-card">
                                <div class="card-header">
                                    <h2 class="card-title">Competitor Performance Benchmarking</h2>
                                    <i class="fas fa-chart-bar card-icon"></i>
                                </div>
                                <div class="chart-container" id="competitor-chart"></div>
                            </div>
                        </div>
                    </div>

                    <div id="recommendations" class="tab-content">
                        <h2 style="margin-bottom: 20px;">Actionable Business Recommendations</h2>
                        <div class="card insight-card">
                            <h3>Recommendation 1: Optimize Marketing Spend</h3>
                            <p><strong>Insight:</strong> Marketing campaigns on social media show 2x higher ROI compared to email campaigns for new customer acquisition.</p>
                            <p><strong>Action:</strong> Reallocate 30% of email marketing budget to social media platforms for the next quarter. Implement A/B testing on ad creatives.</p>
                            <p><strong>Expected Impact:</strong> +5% increase in new customer acquisition rate.</p>
                        </div>
                        <div class="card insight-card">
                            <h3>Recommendation 2: Enhance Customer Support for At-Risk Segment</h3>
                            <p><strong>Insight:</strong> High correlation between unresolved support tickets and churn rate in the 'At-Risk' segment.</p>
                            <p><strong>Action:</strong> Implement a dedicated priority support channel for high-value, at-risk customers. Proactive outreach for unresolved issues.</p>
                            <p><strong>Expected Impact:</strong> Reduce churn by 1-2% among high-value customers.</p>
                        </div>
                        <div class="card insight-card">
                            <h3>Recommendation 3: Personalized Product Bundles</h3>
                            <p><strong>Insight:</strong> ML model identifies common purchase patterns for complementary products among 'Loyal' customers.</p>
                            <p><strong>Action:</strong> Create dynamic product bundles and offer personalized recommendations on product pages and through email campaigns.</p>
                            <p><strong>Expected Impact:</strong> +8% increase in average order value (AOV) and cross-sell revenue.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="aws-sagemaker" class="page">
                <h1 class="page-title">AWS SageMaker Integration</h1>
                <p>Details about AWS SageMaker integration and resources will be displayed here.</p>
                <div class="card">
                    <h3>SageMaker Resources Overview</h3>
                    <p><strong>Region:</strong> <span id="aws-region"></span></p>
                    <p><strong>S3 Data Bucket:</strong> <span id="aws-s3-data"></span></p>
                    <p><strong>Sagemaker Training Instance:</strong> <span id="aws-training-instance"></span></p>
                    <p><strong>Sagemaker Inference Instance:</strong> <span id="aws-inference-instance"></span></p>
                    <p><em>(Dynamic content to be loaded by JavaScript)</em></p>
                </div>
            </div>

            <div id="gcp-vertexai" class="page">
                <h1 class="page-title">GCP Vertex AI Integration</h1>
                <p>Details about GCP Vertex AI integration and resources will be displayed here.</p>
                <div class="card">
                    <h3>Vertex AI Resources Overview</h3>
                    <p><strong>Project ID:</strong> <span id="gcp-project-id"></span></p>
                    <p><strong>Region:</strong> <span id="gcp-region"></span></p>
                    <p><strong>Machine Type:</strong> <span id="gcp-machine-type"></span></p>
                    <p><strong>Accelerator:</strong> <span id="gcp-accelerator"></span></p>
                    <p><em>(Dynamic content to be loaded by JavaScript)</em></p>
                </div>
            </div>

            <div id="tableau-powerbi" class="page">
                <h1 class="page-title">Data Visualization Platforms</h1>
                <p>Integration details for Tableau and Power BI will be displayed here.</p>
                <div class="card-grid">
                    <div class="card">
                        <h3>Tableau Server Details</h3>
                        <p><strong>Server URL:</strong> <span id="tableau-url"></span></p>
                        <p><strong>Site ID:</strong> <span id="tableau-site-id"></span></p>
                        <p><strong>Popular Workbooks:</strong></p>
                        <ul id="tableau-workbooks">
                            </ul>
                    </div>
                    <div class="card">
                        <h3>Power BI Integration</h3>
                        <p><strong>Tenant ID:</strong> <span id="powerbi-tenant-id"></span></p>
                        <p><strong>Workspace:</strong> <span id="powerbi-workspace"></span></p>
                        <p><strong>Key Datasets:</strong></p>
                        <ul id="powerbi-datasets">
                            </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Sample Data for Charts
        const SAMPLE_DATA = {
            salesData: [
                { date: '2024-01-01', amount: 1250, transactions: 45 },
                { date: '2024-01-02', amount: 1180, transactions: 42 },
                { date: '2024-01-03', amount: 1320, transactions: 48 },
                { date: '2024-01-04', amount: 1450, transactions: 52 },
                { date: '2024-01-05', amount: 1380, transactions: 49 },
                { date: '2024-01-06', amount: 1560, transactions: 58 },
                { date: '2024-01-07', amount: 1680, transactions: 61 },
                { date: '2024-01-08', amount: 1520, transactions: 55 },
                { date: '2024-01-09', amount: 1420, transactions: 51 },
                { date: '2024-01-10', amount: 1350, transactions: 48 }
            ],
            
            customerSegments: {
                'Champions': { count: 234, percentage: 12.3, color: '#FFD700' },
                'Loyal Customers': { count: 567, percentage: 29.8, color: '#4ECDC4' },
                'Potential Loyalists': { count: 456, percentage: 24.0, color: '#45B7D1' },
                'At Risk': { count: 189, percentage: 9.9, color: '#FF6B6B' },
                'Need Attention': { count: 454, percentage: 23.9, color: '#FFEAA7' }
            },
            
            modelPerformance: {
                'sales-forecasting': {
                    accuracy: 94.2,
                    mae: 125.43,
                    rmse: 189.67,
                    r2: 0.924,
                    features: ['Seasonality', 'Trend', 'Marketing Spend', 'Price', 'Competition']
                },
                'churn-prediction': {
                    accuracy: 91.5,
                    precision: 89.3,
                    recall: 90.1,
                    f1: 89.7,
                    features: ['Days Since Last Purchase', 'Purchase Frequency', 'Total Spend', 'Support Tickets']
                },
                'customer-segmentation': {
                    silhouette: 0.67,
                    inertia: 892.3,
                    clusters: 5,
                    features: ['Recency', 'Frequency', 'Monetary', 'Lifetime Value']
                },
                'price-optimization': {
                    accuracy: 87.3,
                    mae: 2.45,
                    revenue_impact: 15.6,
                    r2: 0.87,
                    features: ['Current Price', 'Competitor Prices', 'Demand Elasticity', 'Cost Structure']
                }
            },
            
            businessMetrics: {
                revenue: {
                    current: 2847000,
                    growth: 12.3,
                    forecast: [2900000, 3100000, 3250000, 3400000, 3600000, 3800000]
                },
                customers: {
                    total: 1847,
                    new: 247,
                    churn_rate: 4.2,
                    ltv_growth: 18.7
                },
                operations: {
                    models_deployed: 12,
                    active_pipelines: 8,
                    predictions_today: 2847,
                    avg_accuracy: 92.4
                }
            }
        };

        // Configuration for different cloud platforms
        const CLOUD_CONFIG = {
            aws: {
                region: 'us-east-1',
                sagemaker: {
                    training_instance: 'ml.m5.large',
                    inference_instance: 'ml.t2.medium'
                },
                s3: {
                    data_bucket: 'bi-platform-data-bucket',
                    model_bucket: 'bi-platform-model-artifacts'
                }
            },
            
            gcp: {
                project_id: 'bi-platform-project-12345',
                region: 'us-central1',
                vertex_ai: {
                    machine_type: 'n1-standard-4',
                    accelerator: 'nvidia-tesla-t4'
                },
                bigquery: {
                    dataset: 'bi_platform_dataset',
                    location: 'US'
                }
            },
            
            tableau: {
                server_url: 'https://bi-platform.tableauserver.com',
                site_id: 'bi-platform-site',
                workbooks: [
                    'Executive Dashboard',
                    'Sales Analytics', 
                    'Customer Insights',
                    'ML Monitoring'
                ]
            },
            
            powerbi: {
                tenant_id: '12345678-1234-1234-1234-123456789abc',
                workspace: 'BI Platform Analytics',
                datasets: [
                    'Sales Analytics Dataset',
                    'Customer Insights Dataset',
                    'ML Monitoring Dataset'
                ]
            }
        };

        // ML Model Templates
        const ML_TEMPLATES = {
            'sales-forecasting': {
                name: 'Sales Forecasting Pipeline',
                algorithm: 'ARIMA + ML Hybrid',
                inputs: ['historical_sales', 'seasonality', 'marketing_spend'],
                outputs: ['forecast_values', 'confidence_intervals'],
                metrics: ['MAE', 'RMSE', 'MAPE', 'R²'],
                deployment: 'real-time'
            },
            
            'customer-segmentation': {
                name: 'Customer Segmentation Pipeline',
                algorithm: 'K-Means Clustering',
                inputs: ['recency', 'frequency', 'monetary', 'demographics'],
                outputs: ['segment_labels', 'cluster_centers'],
                metrics: ['Silhouette Score', 'Inertia', 'Calinski-Harabasz'],
                deployment: 'batch'
            },
            
            'churn-prediction': {
                name: 'Churn Prediction Pipeline',
                algorithm: 'Random Forest',
                inputs: ['behavior_features', 'transaction_history', 'support_interactions'],
                outputs: ['churn_probability', 'risk_factors'],
                metrics: ['Accuracy', 'Precision', 'Recall', 'F1-Score', 'AUC'],
                deployment: 'real-time'
            },
            
            'price-optimization': {
                name: 'Price Optimization Pipeline',
                algorithm: 'XGBoost',
                inputs: ['current_price', 'competitor_prices', 'demand_elasticity'],
                outputs: ['optimal_price', 'revenue_impact'],
                metrics: ['MAE', 'RMSE', 'Business Impact'],
                deployment: 'batch'
            }
        };

        // UI Helper Functions
        function formatCurrency(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        }

        function formatPercentage(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'percent',
                minimumFractionDigits: 1,
                maximumFractionDigits: 1
            }).format(value / 100);
        }

        function formatNumber(value) {
            return new Intl.NumberFormat('en-US').format(value);
        }

        function generateInsightText(type, data) {
            const insights = {
                revenue: [
                    `Revenue growth of ${data.growth}% indicates strong market performance`,
                    `Seasonal trends show ${data.peak_month} as the highest performing month`,
                    `Customer acquisition cost has improved by ${data.cac_improvement}%`
                ],
                churn: [
                    `${data.high_risk} customers identified as high churn risk`,
                    `Primary churn factors: ${data.top_factors.join(', ')}`,
                    `Retention strategies show ${data.retention_success}% success rate`
                ],
                segmentation: [
                    `${data.champions} champion customers drive ${data.champion_revenue}% of revenue`,
                    `Potential loyalists segment shows ${data.growth_potential}% growth opportunity`,
                    `At-risk customers require immediate attention for retention`
                ]
            };
            
            return insights[type] || ['No insights available'];
        }

        // Core Application Logic
        class CloudBIDashboard {
            constructor() {
                this.currentPage = 'dashboard';
                this.currentDashboardTab = 'realtime'; // Track active tab for dashboard
                this.currentPerformanceTab = 'metrics'; // Track active tab for model performance
                this.currentInsightsTab = 'revenue'; // Track active tab for business insights
                this.currentWorkflowPanel = 'sales-forecasting-workflow'; // Track active workflow panel
                this.init();
            }

            init() {
                this.setupNavigation();
                this.setupTabs();
                this.setupWorkflowControls();
                this.setupModelSelectors();
                this.loadCloudConfigDetails(); // Load cloud platform config on init
                
                // Ensure initial page content is loaded
                this.showPage(this.currentPage); 
                // Ensure initial dashboard tab content is loaded
                this.loadTabContent(this.currentDashboardTab, 'dashboard');
                // Start real-time updates for KPIs
                this.startRealTimeUpdates();
            }

            setupNavigation() {
                const navLinks = document.querySelectorAll('.nav-link');
                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetPage = link.dataset.page;
                        this.showPage(targetPage);
                        
                        // Update active nav item
                        navLinks.forEach(nav => nav.classList.remove('active'));
                        link.classList.add('active');
                    });
                });
            }

            setupTabs() {
                const tabButtons = document.querySelectorAll('.tab-button');
                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const targetTab = button.dataset.tab;
                        const container = button.closest('.tab-container'); // Find the closest tab container
                        
                        // Determine which page's tabs these are to store the current tab correctly
                        let pageId;
                        if (container.id === 'dashboard' || container.closest('#dashboard')) {
                            pageId = 'dashboard';
                            this.currentDashboardTab = targetTab;
                        } else if (container.closest('#model-performance')) {
                            pageId = 'model-performance';
                            this.currentPerformanceTab = targetTab;
                        } else if (container.closest('#business-insights')) {
                            pageId = 'business-insights';
                            this.currentInsightsTab = targetTab;
                        }

                        // Update tab buttons within the specific container
                        container.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        // Update tab content within the specific container
                        container.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                        container.querySelector(`#${targetTab}`).classList.add('active');
                        
                        // Load tab-specific content
                        this.loadTabContent(targetTab, pageId);
                    });
                });
            }

            showPage(pageId) {
                // Hide all pages
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                
                // Show target page
                document.getElementById(pageId).classList.add('active');
                
                // Load page-specific content
                this.loadPageContent(pageId);
                this.currentPage = pageId;

                // Re-activate the correct tab for the newly shown page
                let activeTabToActivate;
                let tabContainerElement;
                if (pageId === 'dashboard') {
                    activeTabToActivate = this.currentDashboardTab;
                    tabContainerElement = document.querySelector('#dashboard .tab-container');
                } else if (pageId === 'model-performance') {
                    activeTabToActivate = this.currentPerformanceTab;
                    tabContainerElement = document.querySelector('#model-performance .tab-container');
                } else if (pageId === 'business-insights') {
                    activeTabToActivate = this.currentInsightsTab;
                    tabContainerElement = document.querySelector('#business-insights .tab-container');
                } else if (pageId === 'ml-workflows') {
                    // For ML workflows, ensure the correct panel is active
                    this.showWorkflowPanel(this.currentWorkflowPanel);
                    this.loadWorkflowCharts(); // Load workflow chart when page is shown
                    return; // No tabs to activate for ML workflows page itself
                } else if (pageId === 'aws-sagemaker' || pageId === 'gcp-vertexai' || pageId === 'tableau-powerbi') {
                    // Load specific cloud configuration details
                    this.loadCloudConfigDetails(pageId);
                    return;
                }

                if (tabContainerElement && activeTabToActivate) {
                    tabContainerElement.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    const targetButton = tabContainerElement.querySelector(`[data-tab="${activeTabToActivate}"]`);
                    if (targetButton) {
                        targetButton.classList.add('active');
                        tabContainerElement.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                        const targetContent = tabContainerElement.querySelector(`#${activeTabToActivate}`);
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                    }
                    this.loadTabContent(activeTabToActivate, pageId);
                }
            }

            loadPageContent(pageId) {
                switch(pageId) {
                    case 'dashboard':
                        // Charts loaded by tab content
                        break;
                    case 'ml-workflows':
                        // Charts specific to the ML Workflows page (like the overall diagram)
                        this.createWorkflowDiagram('sales-forecasting-workflow-diagram'); // Specific diagrams for each workflow if needed
                        this.createWorkflowDiagram('customer-segmentation-workflow-diagram');
                        this.createWorkflowDiagram('churn-prediction-workflow-diagram');
                        this.createWorkflowDiagram('price-optimization-workflow-diagram');
                        break;
                    case 'model-performance':
                        // Charts loaded by tab content
                        break;
                    case 'business-insights':
                        // Charts loaded by tab content
                        break;
                }
            }

            loadTabContent(tabId, pageId) {
                switch(pageId) {
                    case 'dashboard':
                        if (tabId === 'realtime') {
                            this.loadRealtimeCharts();
                        } else if (tabId === 'predictive') {
                            this.loadPredictiveCharts();
                        } else if (tabId === 'overview') {
                            this.loadModelOverview();
                        }
                        break;
                    case 'model-performance':
                        if (tabId === 'metrics') {
                            this.loadDetailedPerformanceMetrics();
                        } else if (tabId === 'validation') {
                            this.loadModelValidationCharts();
                        } else if (tabId === 'features') {
                            this.loadFeatureAnalysisCharts();
                        } else if (tabId === 'monitoring') {
                            this.loadRealtimeMonitoringCharts();
                        }
                        break;
                    case 'business-insights':
                        if (tabId === 'revenue') {
                            this.loadRevenueIntelligenceCharts();
                        } else if (tabId === 'customer') {
                            this.loadCustomerAnalyticsCharts();
                        } else if (tabId === 'market') {
                            this.loadMarketTrendsCharts();
                        } else if (tabId === 'recommendations') {
                            // Recommendations content is mostly static HTML, no charts to load
                        }
                        break;
                }
            }
            // Chart Loading Methods - Dashboard
            loadDashboardCharts() {
                this.createSalesChart();
                this.createSegmentsChart();
                this.createRevenueChart();
            }

            createSalesChart() {
                const dates = this.generateDateRange(30);
                const salesData = dates.map(date => ({
                    x: date,
                    y: Math.random() * 2000 + 1000 + Math.sin(dates.indexOf(date) * 0.2) * 300
                }));

                const trace = {
                    x: salesData.map(d => d.x),
                    y: salesData.map(d => d.y),
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: 'Daily Sales',
                    line: { color: '#FF6B6B', width: 3 },
                    marker: { size: 6 }
                };

                const layout = {
                    title: '',
                    xaxis: { title: 'Date' },
                    yaxis: { title: 'Sales ($)' },
                    margin: { t: 20, l: 60, r: 20, b: 40 },
                    font: { family: 'Arial, sans-serif', size: 12 }
                };
                if (document.getElementById('sales-chart')) {
                    Plotly.newPlot('sales-chart', [trace], layout, { responsive: true });
                }
            }

            createSegmentsChart() {
                const segments = ['High Value', 'Medium Value', 'Low Value', 'New Customers', 'At Risk'];
                const values = [350, 670, 1100, 450, 230];
                const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7'];

                const trace = {
                    labels: segments,
                    values: values,
                    type: 'pie',
                    marker: { colors: colors },
                    textinfo: 'label+percent',
                    textposition: 'outside'
                };

                const layout = {
                    title: '',
                    margin: { t: 20, l: 20, r: 20, b: 20 },
                    font: { family: 'Arial, sans-serif', size: 12 }
                };
                if (document.getElementById('segments-chart')) {
                    Plotly.newPlot('segments-chart', [trace], layout, { responsive: true });
                }
            }

            createRevenueChart() {
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
                const revenue = [120000, 135000, 128000, 142000, 156000, 168000];
                const categories = ['Electronics', 'Clothing', 'Home & Garden', 'Sports', 'Books'];
                const categoryRevenue = [85000, 65000, 45000, 35000, 25000];

                const revenueTrace = {
                    x: months,
                    y: revenue,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: 'Monthly Revenue',
                    line: { color: '#4ECDC4', width: 3 },
                    yaxis: 'y'
                };

                const categoryTrace = {
                    x: categories,
                    y: categoryRevenue,
                    type: 'bar',
                    name: 'Category Revenue',
                    marker: { color: '#45B7D1' },
                    yaxis: 'y2'
                };

                const layout = {
                    title: '',
                    xaxis: { domain: [0, 0.48] },
                    xaxis2: { domain: [0.52, 1] },
                    yaxis: { title: 'Revenue ($)', side: 'left' },
                    yaxis2: { title: 'Category Revenue ($)', side: 'right', overlaying: 'y', anchor: 'x2' },
                    margin: { t: 20, l: 60, r: 60, b: 40 },
                    font: { family: 'Arial, sans-serif', size: 12 }
                };
                if (document.getElementById('revenue-chart')) {
                    Plotly.newPlot('revenue-chart', [revenueTrace, categoryTrace], layout, { responsive: true });
                }
            }

            loadRealtimeCharts() {
                this.loadDashboardCharts();
            }

            // Predictive Charts
            loadPredictiveCharts() {
                this.createForecastChart();
                this.createCLVChart();
                this.createChurnChart();
            }

            createForecastChart() {
                const historicalDates = this.generateDateRange(30, -30);
                const forecastDates = this.generateDateRange(30, 0);
                
                const historicalSales = historicalDates.map((date, i) => 
                    1000 + Math.sin(i * 0.2) * 200 + Math.random() * 100
                );
                
                const forecastSales = forecastDates.map((date, i) => 
                    1100 + Math.sin(i * 0.2) * 200 + i * 5 + Math.random() * 50
                );
                
                const upperBound = forecastSales.map(val => val * 1.2);
                const lowerBound = forecastSales.map(val => val * 0.8);

                const traces = [
                    {
                        x: historicalDates,
                        y: historicalSales,
                        type: 'scatter',
                        mode: 'lines',
                        name: 'Historical Sales',
                        line: { color: '#FF6B6B', width: 2 }
                    },
                    {
                        x: forecastDates,
                        y: forecastSales,
                        type: 'scatter',
                        mode: 'lines',
                        name: 'Forecast',
                        line: { color: '#4ECDC4', width: 2, dash: 'dash' }
                    },
                    {
                        x: forecastDates,
                        y: upperBound,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: 'rgba(0,0,0,0)' },
                        showlegend: false
                    },
                    {
                        x: forecastDates,
                        y: lowerBound,
                        type: 'scatter',
                        mode: 'lines',
                        fill: 'tonexty',
                        fillcolor: 'rgba(78, 205, 196, 0.2)',
                        line: { color: 'rgba(0,0,0,0)' }
                    }
                ];

                const layout = {
                    title: '30-Day Sales Forecast',
                    xaxis: { title: 'Date' },
                    yaxis: { title: 'Sales ($)' },
                    margin: { t: 40, l: 60, r: 20, b: 40 },
                    hovermode: 'x unified'
                };
                if (document.getElementById('forecast-chart')) {
                    Plotly.newPlot('forecast-chart', traces, layout, { responsive: true });
                }
            }

            createCLVChart() {
                const clvData = Array.from({length: 1000}, () => 
                    Math.random() * 4000 + 200 + Math.random() * Math.random() * 2000
                );

                const trace = {
                    x: clvData,
                    type: 'histogram',
                    nbinsx: 20,
                    name: 'CLV Distribution',
                    marker: { color: '#45B7D1' }
                };

                const layout = {
                    title: 'Customer Lifetime Value Distribution',
                    xaxis: { title: 'Predicted CLV ($)' },
                    yaxis: { title: 'Number of Customers' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('clv-chart')) {
                    Plotly.newPlot('clv-chart', [trace], layout, { responsive: true });
                }
            }

            createChurnChart() {
                const riskLevels = ['High Risk', 'Medium Risk', 'Low Risk'];
                const customerCounts = [342, 567, 891];
                const colors = ['#FF6B6B', '#FFD93D', '#6BCF7F'];

                const trace = {
                    x: riskLevels,
                    y: customerCounts,
                    type: 'bar',
                    marker: { color: colors },
                    name: 'Customer Risk Distribution'
                };

                const layout = {
                    title: 'Customer Churn Risk Distribution',
                    xaxis: { title: 'Risk Level' },
                    yaxis: { title: 'Number of Customers' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('churn-chart')) {
                    Plotly.newPlot('churn-chart', [trace], layout, { responsive: true });
                }
            }

            loadModelOverview() {
                // This function ensures the model overview tab content is rendered.
                // The status cards are mostly static HTML, but the data can be sourced from SAMPLE_DATA
                // if they become dynamic.
            }
            // Workflow Methods
            setupWorkflowControls() {
                const workflowSelect = document.getElementById('workflow-select');
                if (workflowSelect) {
                    workflowSelect.addEventListener('change', (e) => {
                        this.showWorkflowPanel(e.target.value);
                    });
                }

                const horizonSlider = document.getElementById('horizon-slider');
                if (horizonSlider) {
                    horizonSlider.addEventListener('input', (e) => {
                        document.getElementById('horizon-value').textContent = e.target.value;
                    });
                }
            }

            showWorkflowPanel(workflowType) {
                // Hide all workflow panels
                document.querySelectorAll('.workflow-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                
                // Show selected panel
                const targetPanel = document.getElementById(workflowType);
                if (targetPanel) {
                    targetPanel.classList.add('active');
                    this.currentWorkflowPanel = workflowType; // Update the current active workflow panel
                    // Re-draw the workflow diagram for the activated panel if it exists
                    this.createWorkflowDiagram(`${workflowType}-diagram`); 
                }
            }

            loadWorkflowCharts() {
                // This ensures all workflow diagrams are initialized when the page is loaded
                this.createWorkflowDiagram('sales-forecasting-workflow-diagram');
                this.createWorkflowDiagram('customer-segmentation-workflow-diagram');
                this.createWorkflowDiagram('churn-prediction-workflow-diagram');
                this.createWorkflowDiagram('price-optimization-workflow-diagram');
            }

            createWorkflowDiagram(chartId) {
                const stepsMap = {
                    'sales-forecasting-workflow-diagram': ['Data Ingestion', 'Preprocessing', 'Feature Engineering', 'Model Training (ARIMA+XGBoost)', 'Validation', 'Deployment', 'Forecast Generation'],
                    'customer-segmentation-workflow-diagram': ['Data Ingestion', 'Clustering Features', 'K-Means Clustering', 'Segment Profiling', 'Deployment', 'New Customer Assignment'],
                    'churn-prediction-workflow-diagram': ['Data Collection', 'Feature Engineering', 'Model Training (Random Forest)', 'Evaluation', 'Deployment', 'Churn Probability Scores'],
                    'price-optimization-workflow-diagram': ['Market Data Ingestion', 'Elasticity Modeling', 'Optimization Algorithm', 'Validation', 'Deployment', 'Optimal Price Recommendation']
                };

                const steps = stepsMap[chartId] || ['Step 1', 'Step 2', 'Step 3', 'Step 4', 'Step 5', 'Step 6'];
                
                const x = steps.map((_, i) => i);
                const y = steps.map(() => 1);
                
                const trace = {
                    x: x,
                    y: y,
                    mode: 'markers+text',
                    text: steps,
                    textposition: 'top center',
                    marker: {
                        size: 20,
                        color: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#9c88ff']
                    },
                    type: 'scatter'
                };
                
                const layout = {
                    title: '', // Title is now handled by H3 in HTML
                    xaxis: { showgrid: false, zeroline: false, showticklabels: false },
                    yaxis: { showgrid: false, zeroline: false, showticklabels: false, range: [0.5, 1.5] },
                    margin: { t: 40, l: 20, r: 20, b: 20 },
                    height: 200,
                    hovermode: false
                };
                
                const workflowChartElement = document.getElementById(chartId);
                if (workflowChartElement) {
                    Plotly.newPlot(chartId, [trace], layout, { responsive: true, displayModeBar: false });
                }
            }

            // Pipeline Execution
            executePipeline() {
                const logContainer = document.getElementById('execution-log');
                const resultsContainer = document.getElementById('execution-results');
                const workflowType = document.getElementById('workflow-select').value;
                
                if (!logContainer) return;
                
                const steps = [
                    'Initializing cloud environment...',
                    'Loading data from source (S3/BigQuery)...',
                    'Preprocessing data for ' + workflowType.replace('-workflow', '') + '...',
                    'Feature engineering for model inputs...',
                    'Splitting data into train/validation sets...',
                    'Training model on ' + CLOUD_CONFIG.aws.sagemaker.training_instance + '...',
                    'Validating model performance...',
                    'Generating predictions/insights...',
                    'Saving model artifacts...',
                    'Deploying model endpoint (if applicable)...',
                    'Pipeline completed successfully!'
                ];
                
                let currentStep = 0;
                logContainer.innerHTML = '';
                resultsContainer.style.display = 'none'; // Hide results until done
                
                const executeStep = () => {
                    if (currentStep < steps.length) {
                        const timestamp = new Date().toLocaleTimeString();
                        const logEntry = `[${timestamp}] ${steps[currentStep]}\n`; // Added newline character
                        logContainer.innerHTML += logEntry;
                        logContainer.scrollTop = logContainer.scrollHeight;
                        
                        currentStep++;
                        setTimeout(executeStep, 700); // Faster simulation
                    } else {
                        // Show results
                        if (resultsContainer) {
                            resultsContainer.style.display = 'block';
                            resultsContainer.innerHTML = `
                                <h4>Execution Results</h4>
                                <p><strong>Status:</strong> Successfully Completed</p>
                                <p><strong>Model Accuracy:</strong> 94.2%</p>
                                <p><strong>Training Time:</strong> 12 minutes</p>
                                <p><strong>Endpoint URL:</strong> https://sagemaker.amazonaws.com/endpoints/bi-model</p>
                            `;
                        }
                    }
                };
                
                executeStep();
            }

            // Model Performance Methods
            setupModelSelectors() {
                const modelSelect = document.getElementById('model-select');
                if (modelSelect) {
                    modelSelect.addEventListener('change', (e) => {
                        this.loadModelPerformance(e.target.value);
                    });
                    // Load initial model performance metrics
                    this.loadModelPerformance(modelSelect.value); 
                }
            }

            loadPerformanceCharts() {
                this.createPerformanceTrendChart();
                this.loadDetailedPerformanceMetrics(); // Ensure default tab charts are loaded
            }

            loadDetailedPerformanceMetrics() {
                this.createConfusionMatrix();
                this.createROCCurve();
                this.createPrecisionRecallCurve();
                this.createFeatureImportanceChart();
            }

            createPerformanceTrendChart() {
                const dates = this.generateDateRange(30);
                const accuracy = dates.map(() => 0.92 + (Math.random() - 0.5) * 0.04);
                
                const trace = {
                    x: dates,
                    y: accuracy,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: 'Daily Accuracy',
                    line: { color: '#4ECDC4', width: 3 },
                    marker: { size: 6 }
                };
                
                const trendY = accuracy.map((_, i) => 0.92 + (i / dates.length) * 0.02);
                const trendTrace = {
                    x: dates,
                    y: trendY,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Trend',
                    line: { color: 'red', width: 2, dash: 'dash' }
                };
                
                const layout = {
                    title: 'Model Accuracy Over Time',
                    xaxis: { title: 'Date' },
                    yaxis: { title: 'Accuracy', tickformat: '.1%' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('performance-trend-chart')) {
                    Plotly.newPlot('performance-trend-chart', [trace, trendTrace], layout, { responsive: true });
                }
            }

            createConfusionMatrix() {
                const matrix = [
                    [85, 15],
                    [12, 88]
                ];
                
                const trace = {
                    z: matrix,
                    type: 'heatmap',
                    colorscale: 'Blues',
                    showscale: false,
                    text: matrix,
                    texttemplate: '%{text}',
                    textfont: { size: 16, color: 'white' }
                };
                
                const layout = {
                    title: 'Confusion Matrix',
                    xaxis: { title: 'Predicted', tickvals: [0, 1], ticktext: ['No Churn', 'Churn'] },
                    yaxis: { title: 'Actual', tickvals: [0, 1], ticktext: ['No Churn', 'Churn'] },
                    margin: { t: 40, l: 60, r: 20, b: 40 },
                    height: 300
                };
                if (document.getElementById('confusion-matrix')) {
                    Plotly.newPlot('confusion-matrix', [trace], layout, { responsive: true });
                }
            }

            createROCCurve() {
                const fpr = Array.from({length: 100}, (_, i) => i / 99);
                const tpr = fpr.map(x => Math.min(1, x + 0.3 + Math.random() * 0.1));
                const auc = 0.89;
                
                const rocTrace = {
                    x: fpr,
                    y: tpr,
                    type: 'scatter',
                    mode: 'lines',
                    name: `ROC Curve (AUC = ${auc.toFixed(3)})`,
                    line: { color: 'blue', width: 3 }
                };
                
                const diagonalTrace = {
                    x: [0, 1],
                    y: [0, 1],
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Random Classifier',
                    line: { color: 'red', width: 2, dash: 'dash' }
                };
                
                const layout = {
                    title: 'ROC Curve',
                    xaxis: { title: 'False Positive Rate' },
                    yaxis: { title: 'True Positive Rate' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('roc-curve')) {
                    Plotly.newPlot('roc-curve', [rocTrace, diagonalTrace], layout, { responsive: true });
                }
            }

            createPrecisionRecallCurve() {
                // Dummy data for Precision-Recall Curve
                const recall = Array.from({length: 100}, (_, i) => i / 99);
                const precision = recall.map(x => Math.max(0.1, Math.min(1, 0.7 + Math.sin(x * 5) * 0.2 + Math.random() * 0.1)));

                const prTrace = {
                    x: recall,
                    y: precision,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Precision-Recall Curve',
                    line: { color: 'green', width: 3 }
                };

                const layout = {
                    title: 'Precision-Recall Curve',
                    xaxis: { title: 'Recall' },
                    yaxis: { title: 'Precision' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('pr-curve')) {
                    Plotly.newPlot('pr-curve', [prTrace], layout, { responsive: true });
                }
            }

            createFeatureImportanceChart() {
                const features = [
                    'Days Since Last Purchase',
                    'Purchase Frequency', 
                    'Total Spend',
                    'Customer Support Tickets',
                    'Email Engagement',
                    'Average Order Value'
                ];
                const importance = [0.28, 0.22, 0.18, 0.12, 0.09, 0.11];
                
                const trace = {
                    x: importance,
                    y: features,
                    type: 'bar',
                    orientation: 'h',
                    marker: {
                        color: importance,
                        colorscale: 'Viridis'
                    }
                };
                
                const layout = {
                    title: 'Feature Importance Ranking',
                    xaxis: { title: 'Importance Score' },
                    margin: { t: 40, l: 150, r: 20, b: 40 }
                };
                if (document.getElementById('feature-importance')) {
                    Plotly.newPlot('feature-importance', [trace], layout, { responsive: true });
                }
            }

            loadModelValidationCharts() {
                this.createCVScoresChart();
                this.createLearningCurvesChart();
            }

            createCVScoresChart() {
                const folds = ['Fold 1', 'Fold 2', 'Fold 3', 'Fold 4', 'Fold 5'];
                const accuracyScores = [0.91, 0.93, 0.90, 0.92, 0.94];
                const f1Scores = [0.88, 0.90, 0.87, 0.89, 0.91];

                const traceAccuracy = {
                    x: folds,
                    y: accuracyScores,
                    type: 'bar',
                    name: 'Accuracy',
                    marker: { color: '#667eea' }
                };

                const traceF1 = {
                    x: folds,
                    y: f1Scores,
                    type: 'bar',
                    name: 'F1 Score',
                    marker: { color: '#4ECDC4' }
                };

                const layout = {
                    title: 'Cross-Validation Scores',
                    barmode: 'group',
                    xaxis: { title: 'Fold' },
                    yaxis: { title: 'Score', range: [0.8, 1.0] },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('cv-scores-chart')) {
                    Plotly.newPlot('cv-scores-chart', [traceAccuracy, traceF1], layout, { responsive: true });
                }
            }

            createLearningCurvesChart() {
                const trainingSizes = [100, 200, 400, 800, 1600, 3200];
                const trainingScores = [0.98, 0.96, 0.94, 0.92, 0.91, 0.90];
                const validationScores = [0.70, 0.78, 0.84, 0.88, 0.90, 0.91];

                const traceTraining = {
                    x: trainingSizes,
                    y: trainingScores,
                    mode: 'lines+markers',
                    name: 'Training Score',
                    line: { color: '#FF6B6B' }
                };

                const traceValidation = {
                    x: trainingSizes,
                    y: validationScores,
                    mode: 'lines+markers',
                    name: 'Validation Score',
                    line: { color: '#45B7D1' }
                };

                const layout = {
                    title: 'Learning Curves',
                    xaxis: { title: 'Training Set Size' },
                    yaxis: { title: 'Score', range: [0.6, 1.0] },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('learning-curves-chart')) {
                    Plotly.newPlot('learning-curves-chart', [traceTraining, traceValidation], layout, { responsive: true });
                }
            }

            loadFeatureAnalysisCharts() {
                this.createFeatureImportanceChart();
                this.createCorrelationMatrix();
            }

            createCorrelationMatrix() {
                const features = ['F1', 'F2', 'F3', 'F4', 'F5'];
                const matrix = [
                    [1.0, 0.7, 0.2, 0.1, 0.5],
                    [0.7, 1.0, 0.3, 0.2, 0.6],
                    [0.2, 0.3, 1.0, 0.8, 0.1],
                    [0.1, 0.2, 0.8, 1.0, 0.2],
                    [0.5, 0.6, 0.1, 0.2, 1.0]
                ];

                const trace = {
                    z: matrix,
                    x: features,
                    y: features,
                    type: 'heatmap',
                    colorscale: 'RdBu',
                    colorbar: { title: 'Correlation' },
                    hovertemplate: 'X: %{x}<br>Y: %{y}<br>Correlation: %{z:.2f}<extra></extra>'
                };

                const layout = {
                    title: 'Feature Correlation Matrix',
                    xaxis: { tickangle: -45 },
                    yaxis: { automargin: true },
                    margin: { t: 40, l: 80, r: 20, b: 80 }
                };
                if (document.getElementById('correlation-matrix')) {
                    Plotly.newPlot('correlation-matrix', [trace], layout, { responsive: true });
                }
            }

            loadRealtimeMonitoringCharts() {
                this.createResponseTimeChart();
                this.createDataDriftChart();
            }

            createResponseTimeChart() {
                const timestamps = this.generateDateRange(60, -60); // Last 60 minutes
                const responseTimes = timestamps.map((_, i) => Math.random() * 50 + 20 + Math.sin(i * 0.5) * 10);

                const trace = {
                    x: timestamps,
                    y: responseTimes,
                    mode: 'lines',
                    name: 'Response Time (ms)',
                    line: { color: '#667eea', width: 2 }
                };

                const layout = {
                    title: 'Model Response Time (Last Hour)',
                    xaxis: { title: 'Time' },
                    yaxis: { title: 'Response Time (ms)' },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('response-time-chart')) {
                    Plotly.newPlot('response-time-chart', [trace], layout, { responsive: true });
                }
            }

            createDataDriftChart() {
                const dates = this.generateDateRange(30);
                const driftScores = dates.map(() => Math.random() * 0.3 + 0.05);

                const trace = {
                    x: dates,
                    y: driftScores,
                    mode: 'lines+markers',
                    name: 'Data Drift Score',
                    line: { color: '#FF6B6B', width: 2 }
                };

                const layout = {
                    title: 'Data Drift Over Time',
xaxis: { title: 'Date' },
                    yaxis: { title: 'Drift Score', range: [0, 0.5] },
                    shapes: [{
                        type: 'line',
                        x0: dates[0],
                        x1: dates[dates.length - 1],
                        y0: 0.3, // Threshold
                        y1: 0.3,
                        line: { color: 'red', width: 2, dash: 'dot' }
                    }],
                    annotations: [{
                        x: dates[dates.length - 1],
                        y: 0.3,
                        text: 'Threshold',
                        showarrow: false,
                        xanchor: 'left',
                        yanchor: 'bottom',
                        font: { color: 'red' }
                    }],
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('data-drift-chart')) {
                    Plotly.newPlot('data-drift-chart', [trace], layout, { responsive: true });
                }
            }


            loadModelPerformance(modelName) {
                const metrics = SAMPLE_DATA.modelPerformance[modelName];
                if (metrics) {
                    const kpis = document.querySelectorAll('.performance-metric');
                    if (modelName === 'sales-forecasting' || modelName === 'price-optimization') {
                        // For regression models, display R² and MAE/RMSE
                        kpis[0].querySelector('h3').textContent = 'R² Score';
                        kpis[0].querySelector('.kpi-value').textContent = metrics.r2.toFixed(3);
                        kpis[1].querySelector('h3').textContent = 'MAE';
                        kpis[1].querySelector('.kpi-value').textContent = metrics.mae.toFixed(2);
                        kpis[2].querySelector('h3').textContent = 'RMSE';
                        kpis[2].querySelector('.kpi-value').textContent = metrics.rmse.toFixed(2);
                        kpis[3].querySelector('h3').textContent = 'Accuracy (Est)';
                        kpis[3].querySelector('.kpi-value').textContent = metrics.accuracy.toFixed(1) + '%';
                    } else if (modelName === 'customer-segmentation') {
                        // For clustering, display different metrics
                        kpis[0].querySelector('h3').textContent = 'Silhouette Score';
                        kpis[0].querySelector('.kpi-value').textContent = metrics.silhouette.toFixed(2);
                        kpis[1].querySelector('h3').textContent = 'Inertia';
                        kpis[1].querySelector('.kpi-value').textContent = metrics.inertia.toFixed(1);
                        kpis[2].querySelector('h3').textContent = 'Clusters';
                        kpis[2].querySelector('.kpi-value').textContent = metrics.clusters;
                        kpis[3].querySelector('h3').textContent = 'Features Used';
                        kpis[3].querySelector('.kpi-value').textContent = metrics.features.length;
                    } else { // Default to classification metrics for churn-prediction
                        kpis[0].querySelector('h3').textContent = 'Overall Accuracy';
                        kpis[0].querySelector('.kpi-value').textContent = metrics.accuracy.toFixed(1) + '%';
                        kpis[1].querySelector('h3').textContent = 'Precision';
                        kpis[1].querySelector('.kpi-value').textContent = metrics.precision.toFixed(1) + '%';
                        kpis[2].querySelector('h3').textContent = 'Recall';
                        kpis[2].querySelector('.kpi-value').textContent = metrics.recall.toFixed(1) + '%';
                        kpis[3].querySelector('h3').textContent = 'F1 Score';
                        kpis[3].querySelector('.kpi-value').textContent = metrics.f1.toFixed(1) + '%';
                    }
                }
                // For detailed charts, activate the first tab again after model selection
                const performanceTabContainer = document.querySelector('#model-performance .tab-container');
                if (performanceTabContainer) {
                    const firstButton = performanceTabContainer.querySelector('.tab-button');
                    if (firstButton) {
                         firstButton.click(); // Simulate click to load its charts
                    }
                }
            }

            // Business Insights Methods
            loadInsightsCharts() {
                this.loadRevenueIntelligenceCharts();
                this.loadCustomerAnalyticsCharts();
                this.loadMarketTrendsCharts(); // Ensure default tab charts are loaded
            }

            loadRevenueIntelligenceCharts() {
                this.createRevenueForecastChart();
                this.createRevenueDriversChart();
                this.createPricingOptimizationChart();
                this.createCustomerSegmentsMiniChart(); // This is for the optimization card
            }
createRevenueForecastChart() {
                const historicalMonths = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
                const forecastMonths = ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const historicalRevenue = [120000, 135000, 128000, 142000, 156000, 168000];
                const forecastRevenue = [175000, 182000, 189000, 195000, 203000, 210000];
                const upperBound = forecastRevenue.map(val => val * 1.15);
                const lowerBound = forecastRevenue.map(val => val * 0.85);
                
                const traces = [
                    {
                        x: historicalMonths,
                        y: historicalRevenue,
                        type: 'scatter',
                        mode: 'lines',
                        name: 'Historical Revenue',
                        line: { color: '#2E86AB', width: 3 }
                    },
                    {
                        x: forecastMonths,
                        y: forecastRevenue,
                        type: 'scatter',
                        mode: 'lines',
                        name: 'Forecasted Revenue',
                        line: { color: '#A23B72', width: 3, dash: 'dash' }
                    },
                    {
                        x: forecastMonths,
                        y: upperBound,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: 'rgba(0,0,0,0)' },
                        showlegend: false
                    },
                    {
                        x: forecastMonths,
                        y: lowerBound,
                        type: 'scatter',
                        mode: 'lines',
                        fill: 'tonexty',
                        fillcolor: 'rgba(162, 59, 114, 0.2)',
                        line: { color: 'rgba(0,0,0,0)' },
                        name: 'Confidence Interval'
                    }
                ];
                
                const layout = {
                    title: '6-Month Revenue Forecast',
                    xaxis: { title: 'Month' },
                    yaxis: { title: 'Revenue ($)' },
                    margin: { t: 40, l: 80, r: 20, b: 40 },
                    hovermode: 'x unified'
                };
                if (document.getElementById('revenue-forecast-chart')) {
                    Plotly.newPlot('revenue-forecast-chart', traces, layout, { responsive: true });
                }
            }

            createRevenueDriversChart() {
                const drivers = ['Product Sales', 'Service Subscriptions', 'Advertising', 'Partnerships'];
                const revenueShare = [0.55, 0.30, 0.10, 0.05];
                const colors = ['#4ECDC4', '#A23B72', '#667eea', '#FFD93D'];

                const trace = {
                    labels: drivers,
                    values: revenueShare,
                    type: 'pie',
                    marker: { colors: colors },
                    textinfo: 'label+percent',
                    textposition: 'inside',
                    insidetextorientation: 'radial'
                };

                const layout = {
                    title: 'Revenue Contribution by Driver',
                    margin: { t: 40, l: 20, r: 20, b: 20 }
                };
                if (document.getElementById('revenue-drivers-chart')) {
                    Plotly.newPlot('revenue-drivers-chart', [trace], layout, { responsive: true });
                }
            }

            createPricingOptimizationChart() {
                const prices = [70, 80, 90, 100, 110];
                const demand = [150, 130, 110, 90, 70]; // Example: higher price, lower demand
                const revenue = prices.map((p, i) => p * demand[i]);

                const trace = {
                    x: prices,
                    y: revenue,
                    mode: 'lines+markers',
                    name: 'Revenue vs. Price',
                    line: { color: '#FF6B6B' },
                    marker: { size: 8 }
                };

                const layout = {
                    title: 'Price vs. Revenue',
                    xaxis: { title: 'Price ($)' },
                    yaxis: { title: 'Revenue ($)' },
                    margin: { t: 40, l: 50, r: 20, b: 40 }
                };
                if (document.getElementById('pricing-optimization')) {
                    Plotly.newPlot('pricing-optimization', [trace], layout, { responsive: true });
                }
            }

            createCustomerSegmentsMiniChart() {
                const segments = ['Champions', 'Loyal', 'Potential'];
                const values = [234, 567, 456];
                const colors = ['#FFD700', '#00b894', '#45B7D1'];

                const trace = {
                    labels: segments,
                    values: values,
                    type: 'pie',
                    marker: { colors: colors },
                    textinfo: 'percent',
                    textposition: 'inside',
                    insidetextorientation: 'radial'
                };

                const layout = {
                    title: '',
                    margin: { t: 10, l: 10, r: 10, b: 10 },
                    showlegend: false
                };
                if (document.getElementById('customer-segments')) {
                    Plotly.newPlot('customer-segments', [trace], layout, { responsive: true });
                }
            }

            loadCustomerAnalyticsCharts() {
                this.createCustomerFunnelChart();
                this.createCLVDistributionChart();
            }

            createCustomerFunnelChart() {
                const stages = ['Awareness', 'Interest', 'Consideration', 'Purchase', 'Retention', 'Advocacy'];
                const values = [10000, 5000, 2500, 1200, 800, 300];
                
                const trace = {
                    type: 'funnel',
                    y: stages,
                    x: values,
                    textinfo: 'value+percent initial',
                    marker: {
                        color: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD']
                    }
                };
                
                const layout = {
                    title: 'Customer Journey Funnel',
                    margin: { t: 40, l: 120, r: 20, b: 40 }
                };
                if (document.getElementById('customer-funnel')) {
                    Plotly.newPlot('customer-funnel', [trace], layout, { responsive: true });
                }
            }

            createCLVDistributionChart() {
                const clvData = Array.from({length: 1000}, () => {
                    return Math.random() * 3000 + 200 + Math.exp(Math.random() * 2) * 100;
                });
                
                const trace = {
                    x: clvData,
                    type: 'histogram',
                    nbinsx: 25,
                    name: 'CLV Distribution',
                    marker: { color: 'lightblue' }
                };
                
                const meanCLV = clvData.reduce((a, b) => a + b) / clvData.length;
                
                const layout = {
                    title: 'Customer Lifetime Value Distribution',
                    xaxis: { title: 'CLV ($)' },
                    yaxis: { title: 'Number of Customers' },
                    margin: { t: 40, l: 60, r: 20, b: 40 },
                    shapes: [{
                        type: 'line',
                        x0: meanCLV,
                        x1: meanCLV,
                        y0: 0,
                        y1: 1,
                        yref: 'paper',
                        line: { color: 'red', width: 2, dash: 'dash' }
                    }],
                    annotations: [{
                        x: meanCLV,
                        y: 0.8,
                        yref: 'paper',
                        text: `Mean CLV: $${meanCLV.toFixed(0)}`,
                        showarrow: true,
                        arrowhead: 2,
                        arrowcolor: 'red'
                    }]
                };
                if (document.getElementById('clv-distribution-chart')) {
                    Plotly.newPlot('clv-distribution-chart', [trace], layout, { responsive: true });
                }
            }

            loadMarketTrendsCharts() {
                this.createMarketShareChart();
                this.createCompetitorBenchmarkingChart();
            }

            createMarketShareChart() {
                const dates = this.generateDateRange(12, -12); // Last 12 months
                const marketShare = dates.map(() => 0.20 + (Math.random() - 0.5) * 0.03); // Approx 20% +/- 3%

                const trace = {
                    x: dates,
                    y: marketShare,
                    mode: 'lines+markers',
                    name: 'Our Market Share',
                    line: { color: '#A23B72', width: 3 },
                    marker: { size: 6 }
                };

                const layout = {
                    title: 'Our Market Share Over Time',
                    xaxis: { title: 'Month' },
                    yaxis: { title: 'Market Share', tickformat: '.1%', range: [0.15, 0.25] },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('market-share-chart')) {
                    Plotly.newPlot('market-share-chart', [trace], layout, { responsive: true });
                }
            }

            createCompetitorBenchmarkingChart() {
                const competitors = ['Competitor A', 'Competitor B', 'Competitor C', 'Ours'];
                const scores = [0.75, 0.82, 0.70, 0.88]; // Higher is better

                const trace = {
                    x: competitors,
                    y: scores,
                    type: 'bar',
                    marker: {
                        color: scores.map((s, i) => i === 3 ? '#667eea' : '#4ECDC4') // Highlight "Ours"
                    },
                    name: 'Performance Score'
                };

                const layout = {
                    title: 'Competitor Performance Benchmarking',
                    xaxis: { title: 'Company' },
                    yaxis: { title: 'Performance Score (0-1)', range: [0, 1] },
                    margin: { t: 40, l: 60, r: 20, b: 40 }
                };
                if (document.getElementById('competitor-chart')) {
                    Plotly.newPlot('competitor-chart', [trace], layout, { responsive: true });
                }
            }
   // Cloud Platform Configuration Loader
            loadCloudConfigDetails(pageId = null) {
                if (document.getElementById('aws-region') && (pageId === 'aws-sagemaker' || pageId === null)) {
                    document.getElementById('aws-region').textContent = CLOUD_CONFIG.aws.region;
                    document.getElementById('aws-s3-data').textContent = CLOUD_CONFIG.aws.s3.data_bucket;
                    document.getElementById('aws-training-instance').textContent = CLOUD_CONFIG.aws.sagemaker.training_instance;
                    document.getElementById('aws-inference-instance').textContent = CLOUD_CONFIG.aws.sagemaker.inference_instance;
                }
                if (document.getElementById('gcp-project-id') && (pageId === 'gcp-vertexai' || pageId === null)) {
                    document.getElementById('gcp-project-id').textContent = CLOUD_CONFIG.gcp.project_id;
                    document.getElementById('gcp-region').textContent = CLOUD_CONFIG.gcp.region;
                    document.getElementById('gcp-machine-type').textContent = CLOUD_CONFIG.gcp.vertex_ai.machine_type;
                    document.getElementById('gcp-accelerator').textContent = CLOUD_CONFIG.gcp.vertex_ai.accelerator;
                }
                if (document.getElementById('tableau-url') && (pageId === 'tableau-powerbi' || pageId === null)) {
                    document.getElementById('tableau-url').textContent = CLOUD_CONFIG.tableau.server_url;
                    document.getElementById('tableau-site-id').textContent = CLOUD_CONFIG.tableau.site_id;
                    const tableauUl = document.getElementById('tableau-workbooks');
                    if (tableauUl) {
                        tableauUl.innerHTML = '';
                        CLOUD_CONFIG.tableau.workbooks.forEach(workbook => {
                            const li = document.createElement('li');
                            li.textContent = workbook;
                            tableauUl.appendChild(li);
                        });
                    }
                }
                if (document.getElementById('powerbi-tenant-id') && (pageId === 'tableau-powerbi' || pageId === null)) {
                    document.getElementById('powerbi-tenant-id').textContent = CLOUD_CONFIG.powerbi.tenant_id;
                    document.getElementById('powerbi-workspace').textContent = CLOUD_CONFIG.powerbi.workspace;
                    const powerbiUl = document.getElementById('powerbi-datasets');
                    if (powerbiUl) {
                        powerbiUl.innerHTML = '';
                        CLOUD_CONFIG.powerbi.datasets.forEach(dataset => {
                            const li = document.createElement('li');
                            li.textContent = dataset;
                            powerbiUl.appendChild(li);
                        });
                    }
                }
            }
  // Utility Methods
            generateDateRange(days, offset = 0) {
                const dates = [];
                const today = new Date();
                
                for (let i = 0; i < days; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() + offset + i);
                    dates.push(date.toISOString().split('T')[0]);
                }
                
                return dates;
            }

            generateRandomData(length, min = 0, max = 100) {
                return Array.from({length}, () => Math.random() * (max - min) + min);
            }

            // Real-time Updates for KPI Cards
            startRealTimeUpdates() {
                setInterval(() => {
                    this.updateRealTimeMetrics();
                }, 5000); // Update every 5 seconds for more noticeable change
            }

            updateRealTimeMetrics() {
                // Only update if on the dashboard page and realtime tab
                if (this.currentPage === 'dashboard' && this.currentDashboardTab === 'realtime') {
                    const kpiValues = document.querySelectorAll('#realtime .kpi-card'); // Target only realtime kpi cards
                    kpiValues.forEach(card => {
                        const valueElement = card.querySelector('.kpi-value');
                        const changeElement = card.querySelector('.kpi-change');
                        if (!valueElement || !changeElement) return;

                        let originalContent = valueElement.textContent;
                        let currentValue;
                        let newValue;
                        let changeAmount;
                        let isPercentage = originalContent.includes('%');
                        let isPositive;
    if (isPercentage) {
                            currentValue = parseFloat(originalContent);
                            changeAmount = (Math.random() - 0.5) * 0.2; // Small % change
                            newValue = currentValue + changeAmount;
                            newValue = Math.max(0, Math.min(100, newValue)); // Keep percentage between 0-100
                            isPositive = changeAmount >= 0;
                            valueElement.textContent = newValue.toFixed(1) + '%';
                        } else if (originalContent.includes(',')) {
                            currentValue = parseInt(originalContent.replace(/,/g, ''));
                            changeAmount = Math.floor((Math.random() - 0.5) * 50); // Small number change
                            newValue = currentValue + changeAmount;
                            newValue = Math.max(0, newValue); // Ensure value doesn't go below 0
                            isPositive = changeAmount >= 0;
                            valueElement.textContent = newValue.toLocaleString();
                        } else {
                            // For "Active Models", make it static for now or add specific logic
                            return; 
                        }

                        changeElement.textContent = (isPositive ? '+' : '') + Math.abs(changeAmount).toFixed(1) + (isPercentage ? '%' : '');
                        changeElement.classList.remove('positive', 'negative');
                        changeElement.classList.add(isPositive ? 'positive' : 'negative');
                    });
                }
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new CloudBIDashboard();
        });

        // Global functions for HTML onclick events
        function executePipeline() {
            if(window.dashboard) {
                window.dashboard.executePipeline();
            }
        }
        // updateModelPerformance is handled by event listener on select, no global function needed for that specific element.
    </script>
</body>
</html>
     